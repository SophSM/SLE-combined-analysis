summarize(average = mean(expression)) %>%
ungroup()
p <- ggplot(df.gene, aes(x=sample, y=expression, fill=sample)) +
geom_violin(trim=FALSE) +
labs(title=gene,x = NULL, y="Normalized counts") +
theme(plot.title = element_text(hjust = 0.5, size = 20)) +
ylim(0,17)
p1 <- p + geom_boxplot(width=0.3, color = 'black', fill=NA) +
# geom_jitter(shape=16, position=position_jitter(0.2)) +
scale_fill_manual(values=c('CONTROL' = '#96d4ccff', 'SLE' = '#b493b4ff')) +
geom_point(df_mean, mapping = aes(x = sample, y = average), color = 'white', shape = 18, size = 3) +
geom_line(df_mean, mapping = aes(x = sample, y = average, group = 1), linetype = "dashed")  +
theme_classic()
# p2 <- p1 + theme(legend.position="none") +
#   annotate("text",
#            x = 1:length(table(df.gene$sample)),
#            y = 16,
#            label = paste0('n = ', table(df.gene$sample)),
#            col = "black",
#            vjust = - 1)
p3 <- p1 + annotate("text",
x = 1,
y = 14.5,
label = paste0('p-value = ', signif(pvalue, digits = 2)),
col = "black",
vjust = - 1)
p3 <- p3 + theme(plot.title = element_text(hjust = 0.5, size = 18),
plot.background = element_rect(fill = "white"),
text = element_text(size = 16),
axis.title = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 16),
axis.text.x = element_text(size = 16, angle = 45, vjust = 1),
axis.text.y = element_text(size = 16))
# ggsave(paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violinplot",gene,"-ptest.png"), dpi = 300, plot = p3)
save(p3, file = paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violin/violinplot-",gene,'.RData'))
}
}
p3
p3 <- p3 + theme(plot.title = element_text(hjust = 0.5, size = 18),
plot.background = element_rect(fill = "white"),
text = element_text(size = 16),
axis.title = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 16),
axis.text.x = element_text(size = 16, angle = 45, vjust = 0.5),
axis.text.y = element_text(size = 16))
p3
for (i in 1:length(list.genes_new)){
gene <- list.genes_new[i]
counts.gene <- norm_counts_name[rownames(norm_counts_name)==gene,]
counts.gene<- as.data.frame(t(counts.gene))
expression = counts.gene[,1]
sample = all_data$DISEASE
df.gene <- data.frame(expression, sample)
control.e <- df.gene[df.gene$sample=='CONTROL',]$expression
sle.e<- df.gene[df.gene$sample=='SLE',]$expression
pvalue <- arr_pvalues[i]
if(pvalue < 0.05){
print(gene)
# plot
df_mean <- df.gene %>%
group_by(sample) %>%
summarize(average = mean(expression)) %>%
ungroup()
p <- ggplot(df.gene, aes(x=sample, y=expression, fill=sample)) +
geom_violin(trim=FALSE) +
labs(title=gene,x = NULL, y="Normalized counts") +
theme(plot.title = element_text(hjust = 0.5, size = 20)) +
ylim(0,17)
p1 <- p + geom_boxplot(width=0.3, color = 'black', fill=NA) +
# geom_jitter(shape=16, position=position_jitter(0.2)) +
scale_fill_manual(values=c('CONTROL' = '#96d4ccff', 'SLE' = '#b493b4ff')) +
geom_point(df_mean, mapping = aes(x = sample, y = average), color = 'white', shape = 18, size = 3) +
geom_line(df_mean, mapping = aes(x = sample, y = average, group = 1), linetype = "dashed")  +
theme_classic()
# p2 <- p1 + theme(legend.position="none") +
#   annotate("text",
#            x = 1:length(table(df.gene$sample)),
#            y = 16,
#            label = paste0('n = ', table(df.gene$sample)),
#            col = "black",
#            vjust = - 1)
p3 <- p1 + annotate("text",
x = 1,
y = 14.5,
label = paste0('p-value = ', signif(pvalue, digits = 2)),
col = "black",
vjust = - 1)
p3 <- p3 + theme(plot.title = element_text(hjust = 0.5, size = 18),
plot.background = element_rect(fill = "white"),
text = element_text(size = 16),
axis.title = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 16),
axis.text.x = element_text(size = 16, angle = 45, vjust = 0.5),
axis.text.y = element_text(size = 16))
# ggsave(paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violinplot",gene,"-ptest.png"), dpi = 300, plot = p3)
save(p3, file = paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violin/violinplot-",gene,'.RData'))
}
}
# in local
load(paste0(indir,"violin/violinplot-C2.RData"))
c2 <- p3
load(paste0(indir, "violin/violinplot-C1QC.RData"))
c1qc <- p3
load(paste0(indir, "violin/violinplot-C1QB.RData"))
c1qb <- p3
load(paste0(indir, "violin/violinplot-FCGR2A.RData"))
fcgr2a <- p3
load(paste0(indir, "violin/violinplot-C1QA.RData"))
c1qa<- p3
load(paste0(indir, "violin/violinplot-TNFAIP3.RData"))
tnfaip3 <- p3
load(paste0(indir, "violin/violinplot-ATG5.RData"))
atg5 <- p3
load(paste0(indir, "violin/violinplot-CRP.RData"))
crp <- p3
load(paste0(indir, "violin/violinplot-HLA-DQA1.RData"))
hladqa1 <- p3
fig2_A <- plot_grid(c2, c1qc, c1qb, fcgr2a, c1qa, tnfaip3, atg5, crp, labels = NULL, ncol = 2)
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso.png"), plot = fig2_A, width = 3000, height = 4000, units = 'px')
for (i in 1:length(list.genes_new)){
gene <- list.genes_new[i]
counts.gene <- norm_counts_name[rownames(norm_counts_name)==gene,]
counts.gene<- as.data.frame(t(counts.gene))
expression = counts.gene[,1]
sample = all_data$DISEASE
df.gene <- data.frame(expression, sample)
control.e <- df.gene[df.gene$sample=='CONTROL',]$expression
sle.e<- df.gene[df.gene$sample=='SLE',]$expression
pvalue <- arr_pvalues[i]
if(pvalue < 0.05){
print(gene)
# plot
df_mean <- df.gene %>%
group_by(sample) %>%
summarize(average = mean(expression)) %>%
ungroup()
p <- ggplot(df.gene, aes(x=sample, y=expression, fill=sample)) +
geom_violin(trim=FALSE) +
labs(title=gene,x = NULL, y="Normalized counts", fill = "Samples") +
theme(plot.title = element_text(hjust = 0.5, size = 20)) +
ylim(0,17)
p1 <- p + geom_boxplot(width=0.3, color = 'black', fill=NA) +
# geom_jitter(shape=16, position=position_jitter(0.2)) +
scale_fill_manual(values=c('CONTROL' = '#96d4ccff', 'SLE' = '#b493b4ff')) +
geom_point(df_mean, mapping = aes(x = sample, y = average), color = 'white', shape = 18, size = 3) +
geom_line(df_mean, mapping = aes(x = sample, y = average, group = 1), linetype = "dashed")  +
theme_classic()
# p2 <- p1 + theme(legend.position="none") +
#   annotate("text",
#            x = 1:length(table(df.gene$sample)),
#            y = 16,
#            label = paste0('n = ', table(df.gene$sample)),
#            col = "black",
#            vjust = - 1)
p3 <- p1 + annotate("text",
x = 1,
y = 14.5,
label = paste0('p-value = ', signif(pvalue, digits = 2)),
col = "black",
vjust = - 1)
p3 <- p3 + theme(plot.title = element_text(hjust = 0.5, size = 18),
plot.background = element_rect(fill = "white"),
text = element_text(size = 16),
axis.title = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 16),
axis.text.x = element_text(size = 16, angle = 45, vjust = 0.5),
axis.text.y = element_text(size = 16))
# ggsave(paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violinplot",gene,"-ptest.png"), dpi = 300, plot = p3)
save(p3, file = paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violin/violinplot-",gene,'.RData'))
}
}
# in local
load(paste0(indir,"violin/violinplot-C2.RData"))
c2 <- p3
load(paste0(indir, "violin/violinplot-C1QC.RData"))
c1qc <- p3
load(paste0(indir, "violin/violinplot-C1QB.RData"))
c1qb <- p3
load(paste0(indir, "violin/violinplot-FCGR2A.RData"))
fcgr2a <- p3
load(paste0(indir, "violin/violinplot-C1QA.RData"))
c1qa<- p3
load(paste0(indir, "violin/violinplot-TNFAIP3.RData"))
tnfaip3 <- p3
load(paste0(indir, "violin/violinplot-ATG5.RData"))
atg5 <- p3
load(paste0(indir, "violin/violinplot-CRP.RData"))
crp <- p3
load(paste0(indir, "violin/violinplot-HLA-DQA1.RData"))
hladqa1 <- p3
fig2_A <- plot_grid(c2, c1qc, c1qb, fcgr2a, c1qa, tnfaip3, atg5, crp, labels = NULL, ncol = 2)
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso.png"), plot = fig2_A, width = 3000, height = 4000, units = 'px')
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso.png"), plot = fig2_A, width = 3000, height = 4500, units = 'px')
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso.png"), plot = fig2_A, width = 3000, height = 5000, units = 'px')
fig2_A <- plot_grid(c2, c1qc, c1qb, fcgr2a, c1qa, tnfaip3, atg5, hladqa1, labels = NULL, ncol = 2)
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso.png"), plot = fig2_A, width = 3000, height = 5000, units = 'px')
?plot_grid
fig2_A <- plot_grid(c2 + theme(legend.position="none"),
c1qc+ theme(legend.position="none"),
c1qb+ theme(legend.position="none"),
fcgr2a+ theme(legend.position="none"),
c1qa+ theme(legend.position="none"),
tnfaip3+ theme(legend.position="none"),
atg5+ theme(legend.position="none"),
hladqa1+ theme(legend.position="none"), labels = NULL, ncol = 2)
legend <- get_legend(
# create some space to the left of the legend
fig2_A + theme(legend.box.margin = margin(0, 0, 0, 12))
)
prevAsso_grid <- plot_grid(fig2_A, legend, rel_widths = c(3, .4))
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso.png"), plot = prevAsso_grid, width = 3000, height = 5000, units = 'px')
?get_legend
legend <- get_legend(
c1qc
)
?plot_grid
prevAsso_grid <- plot_grid(fig2_A, legend, rel_widths = c(3, .4))
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso.png"), plot = prevAsso_grid, width = 3000, height = 5000, units = 'px')
fig2_A <- plot_grid(c2 + theme(legend.position="none"),
c1qc+ theme(legend.position="none"),
c1qb+ theme(legend.position="none"),
fcgr2a+ theme(legend.position="none"),
c1qa+ theme(legend.position="none"),
tnfaip3+ theme(legend.position="none"),
atg5+ theme(legend.position="none"),
hladqa1+ theme(legend.position="none"), labels = NULL, ncol = 4)
legend <- get_legend(
c1qc
)
prevAsso_grid <- plot_grid(fig2_A, legend, rel_widths = c(3, .4))
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso_h.png"), plot = prevAsso_grid, width = 3000, height = 5000, units = 'px')
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso_h.png"), plot = prevAsso_grid, width = 5000, height = 3000, units = 'px')
fig2_A <- plot_grid(c2 + theme(legend.position="none"),
c1qc+ theme(legend.position="none"),
c1qb+ theme(legend.position="none"),
fcgr2a+ theme(legend.position="none"),
c1qa+ theme(legend.position="none"),
tnfaip3+ theme(legend.position="none"),
atg5+ theme(legend.position="none"),
crp+ theme(legend.position="none"),
hladqa1+ theme(legend.position="none"), labels = NULL, ncol = 3)
legend <- get_legend(
c1qc
)
prevAsso_grid <- plot_grid(fig2_A, legend, rel_widths = c(3, .4))
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso_h.png"), plot = prevAsso_grid, width = 5000, height = 3000, units = 'px')
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso_h.png"), plot = prevAsso_grid, width = 5000, height = 5000, units = 'px')
for (i in 1:length(list.genes_new)){
gene <- list.genes_new[i]
counts.gene <- norm_counts_name[rownames(norm_counts_name)==gene,]
counts.gene<- as.data.frame(t(counts.gene))
expression = counts.gene[,1]
sample = all_data$DISEASE
df.gene <- data.frame(expression, sample)
control.e <- df.gene[df.gene$sample=='CONTROL',]$expression
sle.e<- df.gene[df.gene$sample=='SLE',]$expression
pvalue <- arr_pvalues[i]
if(pvalue < 0.05){
print(gene)
# plot
df_mean <- df.gene %>%
group_by(sample) %>%
summarize(average = mean(expression)) %>%
ungroup()
p <- ggplot(df.gene, aes(x=sample, y=expression, fill=sample)) +
geom_violin(trim=FALSE) +
labs(title=gene,x = NULL, y="Normalized counts", fill = "Samples") +
theme(plot.title = element_text(hjust = 0.5, size = 20)) +
ylim(0,17)
p1 <- p + geom_boxplot(width=0.3, color = 'black', fill=NA) +
# geom_jitter(shape=16, position=position_jitter(0.2)) +
scale_fill_manual(values=c('CONTROL' = '#96d4ccff', 'SLE' = '#b493b4ff')) +
geom_point(df_mean, mapping = aes(x = sample, y = average), color = 'white', shape = 18, size = 3) +
geom_line(df_mean, mapping = aes(x = sample, y = average, group = 1), linetype = "dashed")  +
theme_classic()
# p2 <- p1 + theme(legend.position="none") +
#   annotate("text",
#            x = 1:length(table(df.gene$sample)),
#            y = 16,
#            label = paste0('n = ', table(df.gene$sample)),
#            col = "black",
#            vjust = - 1)
p3 <- p1 + annotate("text",
x = 1,
y = 14.5,
label = paste0('p-value = ', signif(pvalue, digits = 2)),
col = "black",
vjust = - 1,
size = 14)
p3 <- p3 + theme(plot.title = element_text(hjust = 0.5, size = 18),
plot.background = element_rect(fill = "white"),
text = element_text(size = 16),
axis.title = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 16),
axis.text.x = element_text(size = 16, angle = 45, vjust = 0.5),
axis.text.y = element_text(size = 16))
# ggsave(paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violinplot",gene,"-ptest.png"), dpi = 300, plot = p3)
save(p3, file = paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violin/violinplot-",gene,'.RData'))
}
}
# in local
load(paste0(indir,"violin/violinplot-C2.RData"))
c2 <- p3
load(paste0(indir, "violin/violinplot-C1QC.RData"))
c1qc <- p3
load(paste0(indir, "violin/violinplot-C1QB.RData"))
c1qb <- p3
load(paste0(indir, "violin/violinplot-FCGR2A.RData"))
fcgr2a <- p3
load(paste0(indir, "violin/violinplot-C1QA.RData"))
c1qa<- p3
load(paste0(indir, "violin/violinplot-TNFAIP3.RData"))
tnfaip3 <- p3
load(paste0(indir, "violin/violinplot-ATG5.RData"))
atg5 <- p3
load(paste0(indir, "violin/violinplot-CRP.RData"))
crp <- p3
load(paste0(indir, "violin/violinplot-HLA-DQA1.RData"))
hladqa1 <- p3
fig2_A <- plot_grid(c2 + theme(legend.position="none"),
c1qc+ theme(legend.position="none"),
c1qb+ theme(legend.position="none"),
fcgr2a+ theme(legend.position="none"),
c1qa+ theme(legend.position="none"),
tnfaip3+ theme(legend.position="none"),
atg5+ theme(legend.position="none"),
crp+ theme(legend.position="none"),
hladqa1+ theme(legend.position="none"), labels = NULL, ncol = 3)
legend <- get_legend(
c1qc
)
prevAsso_grid <- plot_grid(fig2_A, legend, rel_widths = c(3, .4))
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso.png"), plot = prevAsso_grid, width = 5000, height = 5000, units = 'px')
for (i in 1:length(list.genes_new)){
gene <- list.genes_new[i]
counts.gene <- norm_counts_name[rownames(norm_counts_name)==gene,]
counts.gene<- as.data.frame(t(counts.gene))
expression = counts.gene[,1]
sample = all_data$DISEASE
df.gene <- data.frame(expression, sample)
control.e <- df.gene[df.gene$sample=='CONTROL',]$expression
sle.e<- df.gene[df.gene$sample=='SLE',]$expression
pvalue <- arr_pvalues[i]
if(pvalue < 0.05){
print(gene)
# plot
df_mean <- df.gene %>%
group_by(sample) %>%
summarize(average = mean(expression)) %>%
ungroup()
p <- ggplot(df.gene, aes(x=sample, y=expression, fill=sample)) +
geom_violin(trim=FALSE) +
labs(title=gene,x = NULL, y="Normalized counts", fill = "Samples") +
theme(plot.title = element_text(hjust = 0.5, size = 20)) +
ylim(0,17)
p1 <- p + geom_boxplot(width=0.3, color = 'black', fill=NA) +
# geom_jitter(shape=16, position=position_jitter(0.2)) +
scale_fill_manual(values=c('CONTROL' = '#96d4ccff', 'SLE' = '#b493b4ff')) +
geom_point(df_mean, mapping = aes(x = sample, y = average), color = 'white', shape = 18, size = 3) +
geom_line(df_mean, mapping = aes(x = sample, y = average, group = 1), linetype = "dashed")  +
theme_classic()
# p2 <- p1 + theme(legend.position="none") +
#   annotate("text",
#            x = 1:length(table(df.gene$sample)),
#            y = 16,
#            label = paste0('n = ', table(df.gene$sample)),
#            col = "black",
#            vjust = - 1)
p3 <- p1 + annotate("text",
x = 1,
y = 14.5,
label = paste0('p-value = ', signif(pvalue, digits = 2)),
col = "black",
vjust = - 1,
size = 12)
p3 <- p3 + theme(plot.title = element_text(hjust = 0.5, size = 18),
plot.background = element_rect(fill = "white"),
text = element_text(size = 16),
axis.title = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 16),
axis.text.x = element_text(size = 16, angle = 45, vjust = 0.5),
axis.text.y = element_text(size = 16))
# ggsave(paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violinplot",gene,"-ptest.png"), dpi = 300, plot = p3)
save(p3, file = paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violin/violinplot-",gene,'.RData'))
}
}
# in local
load(paste0(indir,"violin/violinplot-C2.RData"))
c2 <- p3
load(paste0(indir, "violin/violinplot-C1QC.RData"))
c1qc <- p3
load(paste0(indir, "violin/violinplot-C1QB.RData"))
c1qb <- p3
load(paste0(indir, "violin/violinplot-FCGR2A.RData"))
fcgr2a <- p3
load(paste0(indir, "violin/violinplot-C1QA.RData"))
c1qa<- p3
load(paste0(indir, "violin/violinplot-TNFAIP3.RData"))
tnfaip3 <- p3
load(paste0(indir, "violin/violinplot-ATG5.RData"))
atg5 <- p3
load(paste0(indir, "violin/violinplot-CRP.RData"))
crp <- p3
load(paste0(indir, "violin/violinplot-HLA-DQA1.RData"))
hladqa1 <- p3
fig2_A <- plot_grid(c2 + theme(legend.position="none"),
c1qc+ theme(legend.position="none"),
c1qb+ theme(legend.position="none"),
fcgr2a+ theme(legend.position="none"),
c1qa+ theme(legend.position="none"),
tnfaip3+ theme(legend.position="none"),
atg5+ theme(legend.position="none"),
crp+ theme(legend.position="none"),
hladqa1+ theme(legend.position="none"), labels = NULL, ncol = 3)
legend <- get_legend(
c1qc
)
prevAsso_grid <- plot_grid(fig2_A, legend, rel_widths = c(3, .4))
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso.png"), plot = prevAsso_grid, width = 5000, height = 5000, units = 'px')
for (i in 1:length(list.genes_new)){
gene <- list.genes_new[i]
counts.gene <- norm_counts_name[rownames(norm_counts_name)==gene,]
counts.gene<- as.data.frame(t(counts.gene))
expression = counts.gene[,1]
sample = all_data$DISEASE
df.gene <- data.frame(expression, sample)
control.e <- df.gene[df.gene$sample=='CONTROL',]$expression
sle.e<- df.gene[df.gene$sample=='SLE',]$expression
pvalue <- arr_pvalues[i]
if(pvalue < 0.05){
print(gene)
# plot
df_mean <- df.gene %>%
group_by(sample) %>%
summarize(average = mean(expression)) %>%
ungroup()
p <- ggplot(df.gene, aes(x=sample, y=expression, fill=sample)) +
geom_violin(trim=FALSE) +
labs(title=gene,x = NULL, y="Normalized counts", fill = "Samples") +
theme(plot.title = element_text(hjust = 0.5, size = 20)) +
ylim(0,17)
p1 <- p + geom_boxplot(width=0.3, color = 'black', fill=NA) +
# geom_jitter(shape=16, position=position_jitter(0.2)) +
scale_fill_manual(values=c('CONTROL' = '#96d4ccff', 'SLE' = '#b493b4ff')) +
geom_point(df_mean, mapping = aes(x = sample, y = average), color = 'white', shape = 18, size = 3) +
geom_line(df_mean, mapping = aes(x = sample, y = average, group = 1), linetype = "dashed")  +
theme_classic()
# p2 <- p1 + theme(legend.position="none") +
#   annotate("text",
#            x = 1:length(table(df.gene$sample)),
#            y = 16,
#            label = paste0('n = ', table(df.gene$sample)),
#            col = "black",
#            vjust = - 1)
p3 <- p1 + annotate("text",
x = 1,
y = 14.5,
label = paste0('p-value = ', signif(pvalue, digits = 2)),
col = "black",
vjust = - 1,
size = 6)
p3 <- p3 + theme(plot.title = element_text(hjust = 0.5, size = 18),
plot.background = element_rect(fill = "white"),
text = element_text(size = 16),
axis.title = element_text(size = 16),
legend.title = element_text(size = 16),
legend.text = element_text(size = 16),
axis.text.x = element_text(size = 16, angle = 45, vjust = 0.5),
axis.text.y = element_text(size = 16))
# ggsave(paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violinplot",gene,"-ptest.png"), dpi = 300, plot = p3)
save(p3, file = paste0("/Users/sofiasalazar/Desktop/LAB/meta-analysis-SLE/combined/figures/violin/violinplot-",gene,'.RData'))
}
}
# in local
load(paste0(indir,"violin/violinplot-C2.RData"))
c2 <- p3
load(paste0(indir, "violin/violinplot-C1QC.RData"))
c1qc <- p3
load(paste0(indir, "violin/violinplot-C1QB.RData"))
c1qb <- p3
load(paste0(indir, "violin/violinplot-FCGR2A.RData"))
fcgr2a <- p3
load(paste0(indir, "violin/violinplot-C1QA.RData"))
c1qa<- p3
load(paste0(indir, "violin/violinplot-TNFAIP3.RData"))
tnfaip3 <- p3
load(paste0(indir, "violin/violinplot-ATG5.RData"))
atg5 <- p3
load(paste0(indir, "violin/violinplot-CRP.RData"))
crp <- p3
load(paste0(indir, "violin/violinplot-HLA-DQA1.RData"))
hladqa1 <- p3
fig2_A <- plot_grid(c2 + theme(legend.position="none"),
c1qc+ theme(legend.position="none"),
c1qb+ theme(legend.position="none"),
fcgr2a+ theme(legend.position="none"),
c1qa+ theme(legend.position="none"),
tnfaip3+ theme(legend.position="none"),
atg5+ theme(legend.position="none"),
crp+ theme(legend.position="none"),
hladqa1+ theme(legend.position="none"), labels = NULL, ncol = 3)
legend <- get_legend(
c1qc
)
prevAsso_grid <- plot_grid(fig2_A, legend, rel_widths = c(3, .4))
ggsave(dpi  = 300 , paste0(indir, "violinplot_prevAsso.png"), plot = prevAsso_grid, width = 5000, height = 5000, units = 'px')
